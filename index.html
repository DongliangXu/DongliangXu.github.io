<!DOCTYPE html>
<html>
<head>
   <meta charset="utf-8">
   <link href="http://libs.baidu.com/bootstrap/3.0.3/css/bootstrap.min.css" rel="stylesheet">
   <script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
   <script src="http://libs.baidu.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>
   <style>
   ul.nav-list {
      position: fixed;
  }
  .jumbotron {
  position: relative;
  padding: 40px 0;
  height: 280px;
  color: #fff;
  text-shadow: 0 1px 3px rgba(0,0,0,.4), 0 0 30px rgba(0,0,0,.075);
  background: #020031; /* Old browsers */
  background: -moz-linear-gradient(45deg,  #020031 0%, #6d3353 100%); /* FF3.6+ */
  background: -webkit-gradient(linear, left bottom, right top, color-stop(0%,#020031), color-stop(100%,#6d3353)); /* Chrome,Safari4+ */
  background: -webkit-linear-gradient(45deg,  #020031 0%,#6d3353 100%); /* Chrome10+,Safari5.1+ */
  background: -o-linear-gradient(45deg,  #020031 0%,#6d3353 100%); /* Opera 11.10+ */
  background: -ms-linear-gradient(45deg,  #020031 0%,#6d3353 100%); /* IE10+ */
  background: linear-gradient(45deg,  #020031 0%,#6d3353 100%); /* W3C */
  filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#020031', endColorstr='#6d3353',GradientType=1 ); /* IE6-9 fallback on horizontal gradient */
  -webkit-box-shadow: inset 0 3px 7px rgba(0,0,0,.2), inset 0 -3px 7px rgba(0,0,0,.2);
     -moz-box-shadow: inset 0 3px 7px rgba(0,0,0,.2), inset 0 -3px 7px rgba(0,0,0,.2);
          box-shadow: inset 0 3px 7px rgba(0,0,0,.2), inset 0 -3px 7px rgba(0,0,0,.2);
}
   .jumbotron .container {
      padding-top: 40px;
   }
   </style>
</head>
<body data-spy="scroll" data-target="#myScrollspy">
   <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
      <ul class="nav navbar-nav">
         <li><a>首页</a></li>
         <li><a>16S</a></li>
         <li><a>RNA-Seq</a></li>
         <li><a>外显子组</a></li>
         <li><a>关于</a></li>
      <ul>
      </div>   
   </div>   
   <header class="jumbotron">
      <div class="container">
         <h1>Biostack</h1>
         <p>当生物信息学数据分析爱上服务器，就有了Biostack.</p>
      </div>
   </header>     
	<div class="container">       
		<div class="row">
			<div class="col-md-3" id="myScrollspy">
				   <ul class="nav nav-list nav-stacked affix-top">
   					<li class="active"><a href="#seq-summary"><span class="glyphicon glyphicon-circle-arrow-right pull-right"></span>测序数据说明</a></li>
   					<li><a href="#quality-control"><span class="glyphicon glyphicon-circle-arrow-right pull-right"></span>原始数据质量控制</i></a></li>
   					<li><a href="#data-process"><span class="glyphicon glyphicon-circle-arrow-right pull-right"></span>数据优化</i></a></li>
   					<li><a href="#OTU"><span class="glyphicon glyphicon-circle-arrow-right pull-right"></span>OTU构建</a></li>
   					<li><a href="#species"><span class="glyphicon glyphicon-circle-arrow-right pull-right"></span>物种组成分析</a></li>
   					<li><a href="#Alpha"><span class="glyphicon glyphicon-circle-arrow-right pull-right"></span>Alpha多样性分析</a></li>
   					<li><a href="#Beta"><span class="glyphicon glyphicon-circle-arrow-right pull-right"></span>Beta多样性分析</a></li>
   					<li><a href="#cumulate"><span class="glyphicon glyphicon-circle-arrow-right pull-right"></span>物种累计曲线图</a></li>
   					<li><a href="#Biomarker"><span class="glyphicon glyphicon-circle-arrow-right pull-right"></span>系统分类学生物标记</a></li>
   					<li><a href="#variance-rank"><span class="glyphicon glyphicon-circle-arrow-right pull-right"></span>variance_rnak分析</a></li>
   			   </ul> 
   		</div>
   		<div class="col-md-9">
            <section id="seq-summary">
   			   <div class="page-header">
                  <h1>1. 测序数据说明</h1>
               </div>
               <p>原始数据为Illumina测序得到的原始图像数据经过Base Calling后的序列数据， 文件为FASTQ格式[1]。 FASTQ格式文件存储了读长（read）的碱基及其质量信息。 如下图3-1所示，FASTQ每个读长信息占4行，其中第一行和的第三行由序列标识符和读长名（ID）组成（第一行以“@”开头而第三行以“+”开头；第三行中ID可以省略， 但“+”不能省略），第二行为碱基序列，第四行为对应位置碱基的测序质量分数（如下所示：）</p>
               <p>@HWI-ST531R:144:D11RDACXX:4:1101:1212:1946 1:N:0:ATTCCT</br>
               ATNATGACTCAAGCGCTTCCTCAGTTTAATGAAGCTAACTTCAATGCTGAGATCGTTGACGACATCGAATGGG</br>
               + HWI-ST531R:144:D11RDACXX:4:1101:1212:1946 1:N:0:ATTCCT</br>
               ?A#AFFDFFHGFFHJJGIJJJIICHIIIIJJGGHIIJJIIJIIJIHGI@FEHIIJBFFHGJJIIHHHDFFFFDCCCCEDDCDDCDEACC</p>
               <p>PE文库测序结果每个样品产生两条序列正向（Forward）端和反向（Reverse）端序列，分表描述为R1端和R2端。</p>
            </section>
            <section id="quality-control">
   			   <div class="page-header">
                  <h1>2. 原始数据质量控制</h1>
               </div>
               <h2>2.1 分析方法</h2>
               <p>切除原始测序数据（R1和R2端序列）末端的低质量序列，使用seqtk trimfq （版本1.0-r75），采用默认参数（-q 0.05）。</p>
               <h2>2.2 结果展示</h2>
               <h3>1) 原始数据质量分布</h3>
               <div class="thumbnail">
                  <img src="image/12152_R1_quality_dist.pdf">
               </div>
               <p><b>图 2-1： 质量控制后数据碱基质量分布</b>注：该图为样品的的R1和R2端序列的质量分布图，横坐标是reads碱基坐标，纵轴是由reads 质量评估分数构成的箱线图，其中箱线图的上边缘表示rW, 下边缘表示lW，上四分位线表示Q30，下四分位线表示Q10，中间黑色的线表示中位数。</p>
               <p>数据目录: 00.raw_data</p>
               <h3>2) 质量控制后的质量分布</h3>
               <div class="thumbnail">
                  <img src="image/12152_R2_quality_dist.pdf">
               </div>
               <p><b>图 2-2： 质量控制后数据碱基质量分布</b>注：该图为样品的的R1和R2端序列的质量分布图，横坐标是reads碱基坐标，纵轴是由reads 质量评估分数构成的箱线图，其中箱线图的上边缘表示rW, 下边缘表示lW，上四分位线表示Q30，下四分位线表示Q10，中间黑色的线表示中位数。</p>
               <p>数据目录: 01.quality_control,质量控制后的数据见: fastq目录</p>
            </section>
            <section id="data-process">   
   			   <div class="page-header">
                  <h1>3. 数据优化</h1>
               </div>
               <h2>3.1 分析方法</h2>
               <p>质量控制后的序列通过双端交叠的区域合并形成一条序列（扩增片段），使用FLASH（version 1.2.8） [3] 合并 R1 和 R2 端序列（使用参数-m 10 -x 0.2  -r 290  -f 468 -s 150），</p>
               <p>根据双端引物序列对合并后的序列进行过滤，去除和引物序列不匹配的序列，采用EMBOSS primersearch （版本6.5.7）， 参数：错误率20%；</p>
               <h2>3.2 结果展示</h2>
               <h3>1) 结果描述</h3>
               <h3>2) 数据合并效率</h3>
               <h3>3) 优质数据优化</h3>
            </section>
            <section id="OTU"> 
   			   <div class="page-header">
                  <h1>4. OTU构建</h1>
               </div>
               <h2>4.1 分析方法</h2>
               <p>OTU（Operational Taxonomic Units）是在系统发生学研究中，为了便于进行分析，给某一个分类单元（品系，属，种、分组等）设置的同一标志。 要了解一个样品测序结果中的菌种、菌属等数目信息，就需要对序列进行相似性聚类。通过聚类操作，将序列按照彼此的相似性分归为许多小组，一个小组就是一个OTU。可根据不同的相似度水平，对所有序列进行OTU划分，通常在97%的相似水平下的OTU进行生物信息统计分析。</p>
               <p>使用UPARSE（Usearch 版本8.0.1517）[2] 对质量控制的16S序列进行构建OTU表，具体操作流程：</p>
               <dl class="dl-horizontal">
                  <dt>a)</dt><dd>去除重复序列;</dd>
                  <dt>b)</dt><dd>去掉 size = 1 的序列（去除没有重复的序列）；</dd>
                  <dt>c)</dt><dd>97%的相似度进行聚类；</dd>
                  <dt>d)</dt><dd>使用UCHIME [3] 的 "Gold" database去除嵌合体序列，生成OTU代表序列；</dd>
                  <dt>e)</dt><dd>将每个样品的所有序列 mapping 到OTU代表序列，生成OTU表，及其相对丰度表。</dd>
               </dl>
               <h2>4.2 结果展示</h2>
               <h3>1) OTU 表</h3>
               <h3>2) OTU 热图</h3>
               <div class="thumbnail">
                  <img  src="image/otu_to_taxonmy_table_rank.pdf">
               </div>
               <h3>3) OTU Rank-abundance 曲线</h3>
            </section>
            <section id="species">
   			   <div class="page-header">
                  <h1>5. 物种组成分析</h1>
               </div>
               <h2>5.1 分析方法</h2>
               <p>使用RDP（版本 2.2）[4] 分类器使用Greengenes （版本13.8 ） [5] 对代表序列进行分类，可信度设置为0.8，</p>
               <p>通过RDP的分类结果可以对物种分类分别在门、纲、目、科、属分类等级对对组成进行统计和可视化。</p>
               <p>我们提供条形图和Krona（版本2.4）[6] 两种可视化结果</p>
               <h2>结果展示</h2>
               <h3>1) 结果描述</h3>
               <h3>2) 物种组成条形图</h3>
               <div class="thumbnail">
                  <img src="image/05/04.taxonomy/classify/class_barplot.pdf">
               </div>
               <h3>3) 物种组成分组条形图</h3>
               <div class="thumbnail">
                  <img src="image/05/04.taxonomy/classify/class_barplot_label.pdf">
               </div>   
               <h3>4) 物种组成热图</h3>
               <div class="thumbnail">
                  <img src="image/05/04.taxonomy/classify/family_heatmap.pdf">
               </div>   
               <h3>5) 物种组成 Krona展示</h3>
               <div class="thumbnail">
                  <img src="image/krona.png">
               </div>   
            </section>
            <section id="Alpha">
   			   <div class="page-header">
                  <h1>6. Alpha多样性分析</h1>
               </div>
               <h2>6.1 分析方法</h2>
               <p>Alpha多样性（α-diversity）是通过多样性指数（diversity index，包括 observed species指数， chao1 指数、shannon 指数）反映的单个样品内部的物种多样性，指数大小与样品复杂度成正比。</p>
               <p>稀释曲线(rarefaction curve) 可以用来评价测序量是否足以覆盖所有类群,并间接反映样品中物种的丰富程度。 当曲线趋于平缓时，说明测序数据量合理，更多的数据量对发现新OTU的贡献很小，反之则表明继续测序还可能产生较多新的OTU。我们对所有样品的 alpha 多样性进行计算,并作出相应的稀释曲线图。</p>
               <p>计算菌群丰度（Community richness）的指数有： </p>
               <ul class="list-unstyled">
                  <li>Chao - the Chao1 estimator </li>
                  <li>Ace - the ACE estimator  (http://www.mothur.org/wiki/Ace)；</li>
               </ul>
               <p>计算菌群多样性（Community diversity）的指数有：</p>
               <ul class="list-unstyled">
               <li>Shannon - the Shannon index  (http://www.mothur.org/wiki/Shannon)；</li>
               <li>Simpson - the Simpson index  (http://www.mothur.org/wiki/Simpson)；</li>
               </ul>
               <p>使用 Mothur（版本 1.32.1） [7] 分别对每个样本计算上述几个指数。</p>
               <h2>6.2 结果展示</h2>
               <h3>1) 香农指数稀释曲线</h3>
               <div class="thumbnail">
                  <img  src="image/05/05.alpha/shannon_rarefaction_curve.pdf">
               </div>   
               <h3>2) chao1指数稀释曲线</h3>
               <div class="thumbnail">
                  <img  src="image/05/05.alpha/chao1_rarefaction_curve.pdf">
               </div>   
               <h3>3) observed species指数稀释曲线</h3>
               <div class="thumbnail">
                  <img  src="image/05/05.alpha/observed_species_rarefaction_curve.pdf">
               </div>   
               <h3>4) 多样性指数</h3>
               <div class="thumbnail">
                  <img  src="image/05/05.alpha/shannon_stats.pdf">
               </div>   
            </section>
            <section id="Beta">
   			   <div class="page-header">
                  <h1>7. Beta多样性分析</h1>
               </div>
               <h2>7.1 分析方法</h2>
               <p>Beta 多样性 (β-diversity) 分析是用来研究样品之间在物种多样性差异性。</p>
               <p>UniFrac [8]使用系统进化信息来计算物种群落之间距离，并用来衡量样品之间的差异，广泛用于元基因和16S 数据分析，其计算结果可以作为一种衡量 beta diversity 的指数。</p>
               <p>UniFrac考虑了物种间的进化距离，指数越大表示样品间的差异越大， 分为 weighted UniFrac 和 unweighted UniFrac 两种，其中 weighted UniFrac 考虑了序列的丰度， unweighted UniFrac 不考虑序列丰度。</p>
               <p>UniFrac 计算任意两个样品之间的距离指数，可构建距离矩阵，根据距离矩阵可以使用PcoA进行可视化。</p>
               <p>非度量多维尺度法（NMDS）分析基于OTU表计算距离矩阵，并使用R包 VE</p>
               <h2>7.2 结果展示</h2>
               <h3>1) PcoA分析结果</h3>
               <div class="thumbnail">
                  <img  src="image/05/06.beta/u